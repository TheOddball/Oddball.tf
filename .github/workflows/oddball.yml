name: Build Oddball.tf

on: 
  push:
    branches:
      - master

jobs:
  Build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [12.x]

    steps:
    - uses: actions/checkout@v1
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}
    - name: Npm Install
      run: npm install
    - uses: docker://google/cloud-sdk
    - name: Set up Google Cloud
      run: |
        echo $GCLOUD_SERVICE_KEY | gcloud auth activate-service-account --key-file=-
        gcloud --quiet config set project ${GOOGLE_PROJECT_ID}
      env:
        GCLOUD_SERVICE_KEY: ${{ secrets.GCLOUD_SERVICE_KEY }}
        GOOGLE_PROJECT_ID: ${{ secrets.GOOGLE_PROJECT_ID }}
    
    - name: Build Oddball.tf
      run: npm run build-oddball        
    - name: Upload Oddball.tf
      run: |
        cd dist
        gsutil -m cp -r ./ gs://Oddball.tf
        cd ..

    - name: Build Elise.tf
      run: npm run build-elise        
    - name: Upload Elise.tf
      run: |
        cd dist
        gsutil -m cp -r ./ gs://Elise.tf
        cd ..
        
    - name: Build Skaiyawn.com
      run: npm run build-skiyawn        
    - name: Upload Skaiyawn.com
      run: |
        cd dist
        gsutil -m cp -r ./ gs://Skaiyawn.com
        cd ..
        
    - name: Build SuperSatanSon.com
      run: npm run build-SSS        
    - name: Upload SuperSatanSon.com
      run: |
        cd dist
        gsutil -m cp -r ./ gs://SuperSatanSon.com
        cd ..